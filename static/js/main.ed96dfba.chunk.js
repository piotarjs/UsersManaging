(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t,s){e.exports=s(156)},150:function(e,t,s){},152:function(e,t,s){},154:function(e,t,s){},156:function(e,t,s){"use strict";s.r(t);s(116);var r=s(47),i=(s(129),s(19)),a=(s(131),s(0)),n=s(77),l=s(10),o=s(62),c=s(31),m=s(8),E=s(84),d=s(74);d.initializeApp({apiKey:"AIzaSyDaBb-y1E-RB70QGIYnyz2xI_8ZDkhoC1c",authDomain:"reactlistwithfirebase.firebaseapp.com",databaseURL:"https://reactlistwithfirebase.firebaseio.com",messagingSenderId:"164262586929",projectId:"reactlistwithfirebase",storageBucket:"reactlistwithfirebase.appspot.com"});const u=d.database(),p=d.storage();s(150);var h=s(50),g=s(71),b=s(85);const L="UsersManaging",N={fileName:"Wybierz plik",isError:!1,isLoading:!1,isUploading:!1,listElementIsEdited:"",listElementToDelete:"",listElementToEdit:"",sortColumn:{},sortingOrder:"asc",user:{},users:{},usersFiltered:{}},y=({firstName:e,key:t,secondName:s,uploadFile:r},i,a)=>{void 0===t&&(t=Date.now().toString()),r?a.child(t).put(r[0]).then(n=>{a.child(n.metadata.name).getDownloadURL().then(a=>{i.child(t).set({fileName:r[0].name,firstName:e,key:t,secondName:s,url:a})})}):i.child(t).update({firstName:e,secondName:s})},f=e=>(t,s,{base:r,storage:i})=>{const a=r.ref("users"),n=i.ref("personalPicture");try{t(T(`/${L}`)),a.child(`${e}`).remove().then(()=>n.child(`${e}`).delete().then(()=>a.on("value",e=>{e&&t((e=>({type:"DELETE_FULFILLED",users:e}))(e.val()))})))}catch(l){t((e=>({error:e.message,type:"DELETE_REJECTED"}))(l))}},D=e=>({error:e.message,type:"RETRIEVE_REJECTED"}),F=e=>t=>{try{const{fileName:r,firstName:i,key:a,secondName:n,url:l}=e;t((e=>({type:"EDIT_FULFILLED",user:e}))({fileName:r,firstName:i,key:a,secondName:n,url:l}))}catch(s){t((e=>({error:e.message,type:"EDIT_REJECTED"}))(s))}},T=e=>t=>{try{t((e=>({fileName:e,type:"GET_FILE_NAME_FULFILLED"}))("Wybierz plik")),t(Object(r.push)(e))}catch(s){t(D(s))}},C=e=>t=>{try{t((e=>({listElementIsEdited:e,type:"DETAILS_FULFILLED"}))(e))}catch(s){t((e=>({error:e.message,type:"DETAILS_REJECTED"}))(s))}},I=e=>({listElementToDelete:e,type:"DELETE_HOVER_FULFILLED"}),O=e=>({error:e.message,type:"DELETE_HOVER_REJECTED"}),j=e=>({listElementToEdit:e,type:"EDIT_HOVER_FULFILLED"}),U=s.n(b)()({CREATE:{FULFILLED:(e,{users:t})=>Object.assign({},e,{isError:!1,isUploading:!1,users:t,usersFiltered:t,usersSorted:t}),PENDING:e=>Object.assign({},e,{isError:!1,isUploading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isUploading:!1})},RETRIEVE:{FULFILLED:(e,{users:t})=>Object.assign({},e,{isError:!1,isLoading:!1,users:t,usersFiltered:t,usersSorted:t}),PENDING:e=>Object.assign({},e,{isError:!1,isLoading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})},EDIT:{FULFILLED:(e,{user:t})=>Object.assign({},e,{fileName:t.fileName,isError:!1,user:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},DELETE:{FULFILLED:(e,{users:t})=>Object.assign({},e,{isError:!1,users:t,usersFiltered:t,usersSorted:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},UPDATE:{FULFILLED:(e,{listElementIsEdited:t,users:s})=>Object.assign({},e,{isError:!1,isUploading:!1,listElementIsEdited:t,users:s,usersFiltered:s,usersSorted:s}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isUploading:!1})},DETAILS:{FULFILLED:(e,{listElementIsEdited:t})=>Object.assign({},e,{isError:!1,isUploading:!1,listElementIsEdited:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isUploading:!1})},DELETE_HOVER:{FULFILLED:(e,{listElementToDelete:t})=>Object.assign({},e,{isError:!1,listElementToDelete:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},EDIT_HOVER:{FULFILLED:(e,{listElementToEdit:t})=>Object.assign({},e,{isError:!1,listElementToEdit:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},FILTER:{FULFILLED:(e,{sortColumn:t,usersFiltered:s})=>Object.assign({},e,{isError:!1,isLoading:!1,sortColumn:t,usersFiltered:s,usersSorted:s}),PENDING:e=>Object.assign({},e,{isError:!1,isLoading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})},SORT:{FULFILLED:(e,{sortColumn:t,sortingOrder:s,usersSorted:r})=>Object.assign({},e,{isError:!1,isLoading:!1,sortColumn:t,sortingOrder:s,usersSorted:r}),PENDING:e=>Object.assign({},e,{isError:!1,isLoading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})},GET_FILE_NAME:{FULFILLED:(e,{fileName:t})=>Object.assign({},e,{fileName:t,isError:!1,isLoading:!1}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})}},N);var v=s(5),k=s(87),R=s.n(k);s(152),s(154);var w=class extends a.Component{constructor(){super(...arguments),this.onHighlightBack=(()=>{this.props.highligthChosenElement(),this.props.redirect("/UsersManaging")}),this.deleteUser=(e=>()=>{this.props.deleteUserFromFirebase(e)})}render(){const{user:{firstName:e,secondName:t,key:s,url:r}}=this.props;return a.createElement(v.Container,null,a.createElement(v.Row,{className:"justify-content-center"},a.createElement(v.MDBBtn,{color:"dark",size:"sm",type:"submit",onClick:this.onHighlightBack},"Powr\xf3t"),a.createElement(v.MDBBtn,{color:"danger",size:"sm",type:"submit",onClick:this.deleteUser(s)},"Usu\u0144")),e&&t&&r&&a.createElement(v.Row,{className:"py-4 justify-content-center"},a.createElement(v.Col,{xs:"6",sm:"4",md:"6"},a.createElement("img",{src:r,alt:"Zdj\u0119cie profilowe",className:"rounded-circle img-fluid"})),a.createElement(v.Col,{xs:"12"},a.createElement("h4",{className:"font-weight-bold my-3 text-center"},e," ",t))))}};const _={deleteUserFromFirebase:f,highligthChosenElement:C,redirect:T};var S,z=Object(l.connect)(({firebase:{user:e}})=>({user:e}),_)(w),x=s(69),B=s(68);!function(e){e.firstName="Imi\u0119",e.secondName="Nazwisko"}(S||(S={}));var J=({input:e,meta:{error:t,submitFailed:s}})=>a.createElement("div",null,a.createElement("input",Object.assign({type:"text"},e,{className:"form-control mb-0",placeholder:S[e.name],autoComplete:"off"})),s&&t&&a.createElement("span",{className:"p-1 bg-danger rounded text-white errorText"},t));var P=Object(l.connect)(({firebase:{user:e}})=>({user:e}),null)(J),A=s(88);var M=e=>{var{fileName:t,getFileName:s}=e,r=e.input,{value:i}=r,n=A.a(r,["value"]),{meta:{error:l,submitFailed:o}}=e;return a.createElement("div",null,a.createElement("div",{className:"fileUpload btn btn-primary px-3 py-2"},a.createElement("span",null,t),a.createElement("input",Object.assign({type:"file",className:"my-0 p-5 upload"},n,{id:"uploadFile",onChange:s,accept:"image/*"}))),a.createElement("div",null,o&&l&&a.createElement("span",{className:"p-1 bg-danger rounded text-white errorText"},l)))};const H={getFileName:({target:{value:e}})=>t=>{try{t((e=>({fileName:e,type:"GET_FILE_NAME_FULFILLED"}))(e.length>0?e.slice("C:/\fakepath/".length):"Wybierz plik"))}catch(s){t(O(s))}}};var G=Object(l.connect)(({firebase:{fileName:e}})=>({fileName:e}),H)(M);const W=({fileName:e,firstName:t,secondName:s,uploadFile:r})=>{const i={};return i.firstName=t?t.length>2?"":"Imi\u0119 musi sk\u0142ada\u0107 si\u0119 z co najmniej 3 liter":"Podaj imi\u0119!",i.secondName=s?s.length>2?"":"Nazwisko musi sk\u0142ada\u0107 si\u0119 z co najmniej 3 liter":"Podaj nazwisko!",i.uploadFile=r&&r.length>0?r[0].type.match(/image\/*/)?"":"Wybierz plik graficzny":"Wybierz plik"!==e&&void 0!==e?"":"Wybierz plik!",i};var V=Object(B.a)({form:"List",validate:W})(({handleSubmit:e,addUserToFirebase:t,submitting:s})=>a.createElement("div",null,a.createElement("p",{className:"h4 text-center py-4"},"Wpisz dane u\u017cytkownika"),a.createElement("form",{onSubmit:e(t),className:"md-form"},a.createElement("div",null,a.createElement(x.a,{name:"firstName",component:P})),a.createElement("div",null,a.createElement(x.a,{name:"secondName",component:P})),a.createElement("div",null,a.createElement(x.a,{name:"uploadFile",component:G})),a.createElement("div",{className:"mt-3"},a.createElement(v.MDBBtn,{color:"success",size:"sm",type:"submit",disabled:s},"Zapisz")))));const $={addUserToFirebase:e=>async(t,s,{base:r,storage:i})=>{t({type:"CREATE_PENDING"});const a=r.ref("users"),n=i.ref("personalPicture");try{await y(e,a,n),a.on("value",e=>{e&&t((e=>({type:"CREATE_FULFILLED",users:e}))(e.val()))}),t(Object(h.a)("List")),t(T(`/${L}`))}catch(l){t((e=>({error:e.message,type:"CREATE_REJECTED"}))(l))}}};var Z=Object(l.connect)(null,$)(V);var K=Object(B.a)({enableReinitialize:!0,form:"Edit",validate:W})(class extends a.Component{constructor(){super(...arguments),this.onHighlightBack=(()=>{this.props.redirect("/UsersManaging"),this.props.highligthChosenElement()})}render(){const{handleSubmit:e,submitting:t,updateUserInFirebase:s}=this.props;return a.createElement("div",null,a.createElement("p",{className:"h4 text-center py-4"},"Zmie\u0144 dane u\u017cytkownika"),a.createElement("form",{onSubmit:e(s),className:"md-form"},a.createElement("div",null,a.createElement(x.a,{name:"firstName",component:P})),a.createElement("div",null,a.createElement(x.a,{name:"secondName",component:P})),a.createElement("div",null,a.createElement(x.a,{name:"uploadFile",component:G})),a.createElement("div",null,a.createElement(x.a,{name:"fileName",component:"input",type:"text",hidden:!0})),a.createElement("div",{className:"mt-3"},a.createElement(v.MDBBtn,{color:"dark",size:"sm",type:"submit",onClick:this.onHighlightBack},"Powr\xf3t"),a.createElement(v.MDBBtn,{color:"success",size:"sm",type:"submit",disabled:t},"Zapisz"))))}});const X={editUser:F,highligthChosenElement:C,redirect:T,updateUserInFirebase:e=>async(t,s,{base:r,storage:i})=>{const a=r.ref("users"),n=i.ref("personalPicture");try{e.uploadFile?await n.child(e.key).delete().then(()=>y(e,a,n)):await y(e,a,n),a.on("value",e=>{e&&t((e=>({listElementIsEdited:"",type:"UPDATE_FULFILLED",users:e}))(e.val()))}),t(Object(h.a)("List")),t(T(`/${L}`))}catch(l){t((e=>({error:e.message,type:"UPDATE_REJECTED"}))(l))}}};var Y=Object(l.connect)(({firebase:{fileName:e,listElementIsEdited:t,user:{firstName:s,key:r,secondName:i,url:a}}})=>({fileName:e,initialValues:{fileName:e,firstName:s,key:r,secondName:i,url:a},listElementIsEdited:t}),X)(K),q=s(65);var Q=class extends a.Component{constructor(){super(...arguments),this.onDelete=(e=>t=>{t.stopPropagation(),this.props.deleteUserFromFirebase(`${e}`)}),this.onEdit=(e=>t=>{t.stopPropagation(),this.props.highligthChosenElement(e),this.props.redirect(`/UsersManaging/${e}/edit`)}),this.onDetails=(e=>()=>{this.props.highligthChosenElement(e),this.props.redirect(`/UsersManaging/${e}`)}),this.highlightElementToDelete=(e=>({type:t})=>{this.props.onDeleteHoverHighlight(t,e)}),this.highlightElementToEdit=(e=>({type:t})=>{this.props.onEditHoverHighlight(t,e)}),this.isActive=(e=>q({"bg-danger":this.props.listElementToDelete===e,"bg-primary":this.props.listElementToEdit===e,disabled:this.props.listElementIsEdited===e,isActive:this.props.listElementIsEdited===e})),this.isSorted=(e=>q({[`fa fa-sort-${this.props.sortColumn?this.props.sortColumn.sortingOrder:""}`]:this.props.sortColumn?this.props.sortColumn.sortedByColumn===e:"","ml-1":!0})),this.sortList=((e,t,s)=>()=>{this.props.sortUsersList(e,t,s)})}render(){const{sortingOrder:e,usersFiltered:t,usersSorted:s}=this.props;return a.createElement(v.Card,null,a.createElement(v.CardBody,null,a.createElement("h2",{className:"text-center mb-3"},"LISTA U\u017bYTKOWNIK\xd3W"),a.createElement(v.Table,null,a.createElement(v.TableHead,null,a.createElement("tr",null,a.createElement("td",{onClick:this.sortList(t,e,"firstName"),title:"Sortuj",className:"font-weight-bold sortList"},"Imi\u0119",a.createElement("i",{className:this.isSorted("firstName")})),a.createElement("td",{onClick:this.sortList(t,e,"secondName"),title:"Sortuj",className:"font-weight-bold sortList"},"Nazwisko",a.createElement("i",{className:this.isSorted("secondName")})),a.createElement("td",{className:"font-weight-bold text-center"},"Zdj\u0119cie"),a.createElement("td",{className:"font-weight-bold text-center"},"Usu\u0144/Edytuj"))),a.createElement(v.TableBody,null,Object.values(s).map(({firstName:e,secondName:t,url:s,key:r})=>a.createElement("tr",{key:r,onClick:this.onDetails(r),className:this.isActive(r),title:"Wy\u015bwietl szczeg\xf3\u0142y o u\u017cytkowniku"},a.createElement("td",{className:"w-25"},e),a.createElement("td",{className:"w-25"},t),a.createElement("td",null,a.createElement(v.Row,{className:"justify-content-center"},a.createElement(v.Col,{sm:"4"},a.createElement("img",{src:s,alt:"Zdj\u0119cie profilowe",className:"img-fluid rounded-circle"})))),a.createElement("td",null,a.createElement(v.Row,{className:"justify-content-center"},a.createElement(v.Fa,{icon:"trash",id:"delete",size:"lg",title:"Usu\u0144",type:"submit",onClick:this.onDelete(r),onMouseEnter:this.highlightElementToDelete(r),onMouseLeave:this.highlightElementToDelete(r),className:"mx-2 onDelete"}),a.createElement(v.Fa,{icon:"edit",id:"edit",size:"lg",title:"Edytuj",type:"submit",onClick:this.onEdit(r),onMouseEnter:this.highlightElementToEdit(r),onMouseLeave:this.highlightElementToEdit(r),className:"mx-2"})))))))))}};const ee={deleteUserFromFirebase:f,highligthChosenElement:C,onDeleteHoverHighlight:(e,t)=>s=>{try{s(I("mouseenter"===e?t:""))}catch(r){s(O(r))}},onEditHoverHighlight:(e,t)=>s=>{try{s(j("mouseenter"===e?t:""))}catch(r){s(O(r))}},redirect:T,sortUsersList:(e,t,s)=>async r=>{r({type:"SORT_PENDING"});try{const a={};Object.values(e).sort((e,r)=>((e,t,s)=>"asc"===s?e>t?1:-1:e>t?-1:1)(e[s],r[s],t)).map(({firstName:e,key:t,secondName:s,url:r})=>a[t]={firstName:e,key:t,secondName:s,url:r});const n={sortedByColumn:s,sortingOrder:t};r(((e,t,s)=>({sortColumn:s,sortingOrder:t,type:"SORT_FULFILLED",usersSorted:e}))(a,t="asc"===t?"desc":"asc",n))}catch(i){r((e=>({error:e.message,type:"SORT_REJECTED"}))(i))}}};var te=Object(l.connect)(({firebase:{listElementIsEdited:e,sortingOrder:t,sortColumn:s,listElementToDelete:r,listElementToEdit:i,usersFiltered:a,usersSorted:n}})=>({listElementIsEdited:e,listElementToDelete:r,listElementToEdit:i,sortColumn:s,sortingOrder:t,usersFiltered:a,usersSorted:n}),ee)(Q);var se=class extends a.Component{constructor(){super(...arguments),this.filterList=(e=>({target:{value:t}})=>{this.props.filterUsersList(e,t)})}componentDidMount(){this.props.getUserFromFirebase()}componentDidUpdate(){const{editUser:e,match:t,users:s}=this.props;t.params.key&&s&&e(s[t.params.key])}render(){const{users:e,usersFiltered:t,isLoading:s,isError:r,match:i}=this.props;return a.createElement(v.Container,null,a.createElement(v.Row,{className:"mt-4"},a.createElement(v.Col,{lg:"8"},a.createElement("form",{className:"md-form"},a.createElement("input",{name:"filerList",type:"text",className:"form-control mb-2",placeholder:"Wpisz poszukiwanego u\u017cytkownika",onChange:this.filterList(e)})),s?a.createElement(v.Row,{className:"justify-content-center mt-5"},a.createElement(R.a,{type:"ball-clip-rotate-multiple",active:!0})):r?a.createElement("p",null,"Wyst\u0105pi\u0142 b\u0142\u0105d podczas pobierania danych!!!"):null!==t&&Object.values(t).length>0?a.createElement(te,null):a.createElement("h2",null,"Brak listy do wy\u015bwietlenia")),a.createElement(v.Col,{lg:"4",className:"mt-3 mt-lg-0"},a.createElement(v.Card,null,a.createElement(v.CardBody,null,i.params.key?i.params.action&&"edit"===i.params.action?a.createElement(Y,null):a.createElement(z,null):a.createElement(Z,null))))))}};const re={editUser:F,filterUsersList:(e,t)=>async s=>{s({type:"FILTER_PENDING"});const r=t.toLowerCase();try{const t=Object.values(e).filter(({firstName:e,secondName:t})=>e.toLowerCase().includes(r)||t.toLowerCase().includes(r)),a={};t.forEach(({firstName:e,key:t,secondName:s,url:r})=>a[t]={firstName:e,key:t,secondName:s,url:r}),s(((e,t)=>({sortColumn:t,type:"FILTER_FULFILLED",usersFiltered:e}))(a,{sortedByColumn:"reset",sortingOrder:"reset"}))}catch(i){s((e=>({error:e.message,type:"FILTER_REJECTED"}))(i))}},getUserFromFirebase:()=>async(e,t,{base:s})=>{e({type:"RETRIEVE_PENDING"});try{e((e=>({type:"RETRIEVE_FULFILLED",users:e}))((await s.ref("users").once("value")).val()))}catch(r){e(D(r))}}};var ie=Object(l.connect)(({firebase:{isError:e,isLoading:t,users:s,usersFiltered:r,usersSorted:i}})=>({isError:e,isLoading:t,users:s,usersFiltered:r,usersSorted:i}),re)(se);const ae=Object(i.a)(),ne=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||m.d,le=Object(m.e)((e=>Object(m.c)({firebase:U,form:g.a,router:Object(r.connectRouter)(e)}))(ae),ne(Object(m.a)(E.a.withExtraArgument({base:u,storage:p}),Object(r.routerMiddleware)(ae))));Object(n.render)(a.createElement(()=>a.createElement(l.Provider,{store:le},a.createElement(r.ConnectedRouter,{history:ae},a.createElement("div",null,a.createElement(o.a,null,a.createElement(c.a,{path:`/${L}/:key?/:action?`,component:ie}))))),null),document.querySelector("#container"))}},[[115,2,1]]]);
//# sourceMappingURL=main.ed96dfba.chunk.js.map