(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t,r){e.exports=r(156)},150:function(e,t,r){},152:function(e,t,r){},154:function(e,t,r){},156:function(e,t,r){"use strict";r.r(t);r(116);var s=r(32),i=(r(129),r(19)),a=(r(131),r(0)),n=r(73),l=r(10),o=r(77),c=r(29),m=r(8),E=r(84),d=r(70);d.initializeApp({apiKey:"AIzaSyDaBb-y1E-RB70QGIYnyz2xI_8ZDkhoC1c",authDomain:"reactlistwithfirebase.firebaseapp.com",databaseURL:"https://reactlistwithfirebase.firebaseio.com",messagingSenderId:"164262586929",projectId:"reactlistwithfirebase",storageBucket:"reactlistwithfirebase.appspot.com"});const u=d.database(),p=d.storage();r(150);var h=r(50),g=r(82),b=r(85);const L=({firstName:e,key:t,secondName:r,uploadFile:s},i,a)=>{void 0===t&&(t=Date.now().toString()),a.child(t).put(s[0]).then(s=>{a.child(s.metadata.name).getDownloadURL().then(s=>{i.child(t).set({firstName:e,key:t,secondName:r,url:s})})})},y=e=>(t,r,{base:i,storage:a})=>{const n=i.ref("users"),l=a.ref("personalPicture");try{t(Object(s.push)("/")),n.child(`${e}`).remove().then(()=>l.child(`${e}`).delete().then(()=>n.on("value",e=>{e&&t((e=>({type:"DELETE_FULFILLED",users:e}))(e.val()))})))}catch(o){t((e=>({error:e.message,type:"DELETE_REJECTED"}))(o))}},N=e=>({error:e.message,type:"RETRIEVE_REJECTED"}),f=e=>t=>{try{const{firstName:s,key:i,secondName:a,url:n}=e;t((e=>({type:"EDIT_FULFILLED",user:e}))({firstName:s,key:i,secondName:a,url:n}))}catch(r){t((e=>({error:e.message,type:"EDIT_REJECTED"}))(r))}},D=e=>t=>{try{t((e=>({fileName:e,type:"GET_FILE_NAME_FULFILLED"}))("Wybierz plik")),t(Object(s.push)(e))}catch(r){t(N(r))}},F=e=>t=>{try{t((e=>({listElementIsEdited:e,type:"DETAILS_FULFILLED"}))(e))}catch(r){t((e=>({error:e.message,type:"DETAILS_REJECTED"}))(r))}},T=e=>({listElementToDelete:e,type:"DELETE_HOVER_FULFILLED"}),O=e=>({error:e.message,type:"DELETE_HOVER_REJECTED"}),C=e=>({listElementToEdit:e,type:"EDIT_HOVER_FULFILLED"}),I=r.n(b)()({CREATE:{FULFILLED:(e,{fileName:t,users:r})=>Object.assign({},e,{fileName:t,isError:!1,isUploading:!1,users:r,usersFiltered:r,usersSorted:r}),PENDING:e=>Object.assign({},e,{isError:!1,isUploading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isUploading:!1})},RETRIEVE:{FULFILLED:(e,{users:t})=>Object.assign({},e,{isError:!1,isLoading:!1,users:t,usersFiltered:t,usersSorted:t}),PENDING:e=>Object.assign({},e,{isError:!1,isLoading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})},EDIT:{FULFILLED:(e,{user:t})=>Object.assign({},e,{isError:!1,user:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},DELETE:{FULFILLED:(e,{users:t})=>Object.assign({},e,{isError:!1,users:t,usersFiltered:t,usersSorted:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},UPDATE:{FULFILLED:(e,{fileName:t,listElementIsEdited:r,users:s})=>Object.assign({},e,{fileName:t,isError:!1,isUploading:!1,listElementIsEdited:r,users:s,usersFiltered:s,usersSorted:s}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isUploading:!1})},DETAILS:{FULFILLED:(e,{listElementIsEdited:t})=>Object.assign({},e,{isError:!1,isUploading:!1,listElementIsEdited:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isUploading:!1})},DELETE_HOVER:{FULFILLED:(e,{listElementToDelete:t})=>Object.assign({},e,{isError:!1,listElementToDelete:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},EDIT_HOVER:{FULFILLED:(e,{listElementToEdit:t})=>Object.assign({},e,{isError:!1,listElementToEdit:t}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0})},FILTER:{FULFILLED:(e,{sortColumn:t,usersFiltered:r})=>Object.assign({},e,{isError:!1,isLoading:!1,sortColumn:t,usersFiltered:r,usersSorted:r}),PENDING:e=>Object.assign({},e,{isError:!1,isLoading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})},SORT:{FULFILLED:(e,{sortColumn:t,sortingOrder:r,usersSorted:s})=>Object.assign({},e,{isError:!1,isLoading:!1,sortColumn:t,sortingOrder:r,usersSorted:s}),PENDING:e=>Object.assign({},e,{isError:!1,isLoading:!0}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})},GET_FILE_NAME:{FULFILLED:(e,{fileName:t})=>Object.assign({},e,{fileName:t,isError:!1,isLoading:!1}),REJECTED:(e,{error:t})=>Object.assign({},e,{error:t,isError:!0,isLoading:!1})}},{fileName:"Wybierz plik",isError:!1,isLoading:!1,isUploading:!1,listElementIsEdited:"",listElementToDelete:"",listElementToEdit:"",sortColumn:{},sortingOrder:"asc",user:{},users:{},usersFiltered:{}});var j=r(5),v=r(87),U=r.n(v);r(152),r(154);var k=class extends a.Component{constructor(){super(...arguments),this.onHighlightBack=(()=>{this.props.highligthChosenElement(),this.props.redirect("/")}),this.deleteUser=(e=>()=>{this.props.deleteUserFromFirebase(e)})}render(){const{user:{firstName:e,secondName:t,key:r,url:s}}=this.props;return a.createElement(j.Container,null,a.createElement(j.Row,{className:"justify-content-center"},a.createElement(j.MDBBtn,{color:"dark",size:"sm",type:"submit",onClick:this.onHighlightBack},"Powr\xf3t"),a.createElement(j.MDBBtn,{color:"danger",size:"sm",type:"submit",onClick:this.deleteUser(r)},"Usu\u0144")),e&&t&&s&&a.createElement(j.Row,{className:"py-4 justify-content-center"},a.createElement("img",{src:s,alt:"Zdj\u0119cie profilowe",className:"rounded-circle w-75 h-75"}),a.createElement("h4",{className:"font-weight-bold mb-3"},e," ",t)))}};const R={deleteUserFromFirebase:y,highligthChosenElement:F,redirect:D};var w,_=Object(l.connect)(({firebase:{user:e}})=>({user:e}),R)(k),S=r(81),z=r(80);!function(e){e.firstName="Imi\u0119",e.secondName="Nazwisko"}(w||(w={}));var B=({input:e,meta:{error:t,submitFailed:r}})=>a.createElement("div",null,a.createElement("input",Object.assign({type:"text"},e,{className:"form-control mb-0",placeholder:w[e.name],autoComplete:"off"})),r&&t&&a.createElement("span",{className:"p-1 bg-danger rounded text-white errorText"},t));var J=Object(l.connect)(({firebase:{user:e}})=>({user:e}),null)(B),P=r(88);var x=e=>{var{fileName:t,getFileName:r}=e,s=e.input,{value:i}=s,n=P.a(s,["value"]),{meta:{error:l,submitFailed:o}}=e;return a.createElement("div",null,a.createElement("div",{className:"fileUpload btn btn-primary px-3 py-2"},a.createElement("span",null,t),a.createElement("input",Object.assign({type:"file",className:"my-0 p-5 upload"},n,{id:"uploadFile",onChange:r,accept:"image/*"}))),a.createElement("div",null,o&&l&&a.createElement("span",{className:"p-1 bg-danger rounded text-white errorText"},l)))};const A={getFileName:({target:{value:e}})=>t=>{try{t((e=>({fileName:e,type:"GET_FILE_NAME_FULFILLED"}))(e.length>0?e.slice("C:/\fakepath/".length):"Wybierz plik"))}catch(r){t(O(r))}}};var H=Object(l.connect)(({firebase:{fileName:e}})=>({fileName:e}),A)(x);const M=({firstName:e,secondName:t,uploadFile:r})=>{const s={};return s.firstName=e?e.length>2?"":"Imi\u0119 musi sk\u0142ada\u0107 si\u0119 z co najmniej 3 liter":"Podaj imi\u0119!",s.secondName=t?t.length>2?"":"Nazwisko musi sk\u0142ada\u0107 si\u0119 z co najmniej 3 liter":"Podaj nazwisko!",s.uploadFile=r&&r.length>0?r[0].type.match(/image\/*/)?"":"Wybierz plik graficzny":"Wybierz plik!",s};var W=Object(z.a)({form:"List",validate:M})(({handleSubmit:e,addUserToFirebase:t,pristine:r,submitting:s})=>a.createElement("div",null,a.createElement("p",{className:"h4 text-center py-4"},"Wpisz dane u\u017cytkownika"),a.createElement("form",{onSubmit:e(t),className:"md-form"},a.createElement("div",null,a.createElement(S.a,{name:"firstName",component:J})),a.createElement("div",null,a.createElement(S.a,{name:"secondName",component:J})),a.createElement("div",null,a.createElement(S.a,{name:"uploadFile",component:H})),a.createElement("div",{className:"mt-3"},a.createElement(j.MDBBtn,{color:"success",size:"sm",type:"submit",disabled:r||s},"Zapisz")))));const G={addUserToFirebase:e=>async(t,r,{base:s,storage:i})=>{t({type:"CREATE_PENDING"});const a=s.ref("users"),n=i.ref("personalPicture");try{await L(e,a,n),a.on("value",e=>{e&&t(((e,t)=>({fileName:t,type:"CREATE_FULFILLED",users:e}))(e.val(),"Wybierz plik"))}),t(Object(h.a)("List"))}catch(l){t((e=>({error:e.message,type:"CREATE_REJECTED"}))(l))}}};var V=Object(l.connect)(null,G)(W);var Z=Object(z.a)({enableReinitialize:!0,form:"Edit",validate:M})(class extends a.Component{constructor(){super(...arguments),this.onHighlightBack=(()=>{this.props.redirect("/"),this.props.highligthChosenElement()})}render(){const{handleSubmit:e,pristine:t,submitting:r,updateUserInFirebase:s}=this.props;return a.createElement("div",null,a.createElement("p",{className:"h4 text-center py-4"},"Zmie\u0144 dane u\u017cytkownika"),a.createElement("form",{onSubmit:e(s),className:"md-form"},a.createElement("div",null,a.createElement(S.a,{name:"firstName",component:J})),a.createElement("div",null,a.createElement(S.a,{name:"secondName",component:J})),a.createElement("div",null,a.createElement(S.a,{name:"uploadFile",component:H})),a.createElement("div",{className:"mt-3"},a.createElement(j.MDBBtn,{color:"dark",size:"sm",type:"submit",onClick:this.onHighlightBack},"Powr\xf3t"),a.createElement(j.MDBBtn,{color:"success",size:"sm",type:"submit",disabled:t||r},"Zapisz"))))}});const $={editUser:f,highligthChosenElement:F,redirect:D,updateUserInFirebase:e=>async(t,r,{base:i,storage:a})=>{const n=i.ref("users"),l=a.ref("personalPicture");try{await l.child(e.key).delete().then(()=>L(e,n,l)),n.on("value",e=>{e&&t(((e,t)=>({fileName:t,listElementIsEdited:"",type:"UPDATE_FULFILLED",users:e}))(e.val(),"Wybierz plik"))}),t(Object(h.a)("List")),t(Object(s.push)("/"))}catch(o){t((e=>({error:e.message,type:"UPDATE_REJECTED"}))(o))}}};var K=Object(l.connect)(({firebase:{listElementIsEdited:e,user:{firstName:t,key:r,secondName:s,url:i}}})=>({initialValues:{firstName:t,key:r,secondName:s,url:i},listElementIsEdited:e}),$)(Z),X=r(64);var Y=class extends a.Component{constructor(){super(...arguments),this.onDelete=(e=>t=>{t.stopPropagation(),this.props.deleteUserFromFirebase(`${e}`)}),this.onEdit=(e=>t=>{t.stopPropagation(),this.props.highligthChosenElement(e),this.props.redirect(`/${e}/edit`)}),this.onDetails=(e=>()=>{this.props.highligthChosenElement(e),this.props.redirect(`/${e}`)}),this.highlightElementToDelete=(e=>({type:t})=>{this.props.onDeleteHoverHighlight(t,e)}),this.highlightElementToEdit=(e=>({type:t})=>{this.props.onEditHoverHighlight(t,e)}),this.isActive=(e=>X({"bg-danger":this.props.listElementToDelete===e,"bg-primary":this.props.listElementToEdit===e,disabled:this.props.listElementIsEdited===e,isActive:this.props.listElementIsEdited===e})),this.isSorted=(e=>X({[`fa fa-sort-${this.props.sortColumn?this.props.sortColumn.sortingOrder:""}`]:this.props.sortColumn?this.props.sortColumn.sortedByColumn===e:"","ml-1":!0})),this.sortList=((e,t,r)=>()=>{this.props.sortUsersList(e,t,r)})}render(){const{sortingOrder:e,usersFiltered:t,usersSorted:r}=this.props;return a.createElement(j.Card,null,a.createElement(j.CardBody,null,a.createElement("h2",{className:"text-center mb-3"},"LISTA U\u017bYTKOWNIK\xd3W"),a.createElement(j.Table,null,a.createElement(j.TableHead,null,a.createElement("tr",null,a.createElement("td",{onClick:this.sortList(t,e,"firstName"),title:"Sortuj",className:"font-weight-bold sortList"},"Imi\u0119",a.createElement("i",{className:this.isSorted("firstName")})),a.createElement("td",{onClick:this.sortList(t,e,"secondName"),title:"Sortuj",className:"font-weight-bold sortList"},"Nazwisko",a.createElement("i",{className:this.isSorted("secondName")})),a.createElement("td",{className:"font-weight-bold text-center"},"Zdj\u0119cie"),a.createElement("td",{className:"font-weight-bold text-center"},"Usu\u0144/Edytuj"))),a.createElement(j.TableBody,null,Object.values(r).map(({firstName:e,secondName:t,url:r,key:s})=>a.createElement("tr",{key:s,onClick:this.onDetails(s),className:this.isActive(s),title:"Wy\u015bwietl szczeg\xf3\u0142y o u\u017cytkowniku"},a.createElement("td",{className:"w-25"},e),a.createElement("td",{className:"w-25"},t),a.createElement("td",null,a.createElement(j.Row,{className:"justify-content-center"},a.createElement(j.Col,{sm:"4"},a.createElement("img",{src:r,alt:"Zdj\u0119cie profilowe",className:"img-fluid rounded-circle"})))),a.createElement("td",null,a.createElement(j.Row,{className:"justify-content-center"},a.createElement(j.Fa,{icon:"trash",id:"delete",size:"lg",title:"Usu\u0144",type:"submit",onClick:this.onDelete(s),onMouseEnter:this.highlightElementToDelete(s),onMouseLeave:this.highlightElementToDelete(s),className:"mx-2 onDelete"}),a.createElement(j.Fa,{icon:"edit",id:"edit",size:"lg",title:"Edytuj",type:"submit",onClick:this.onEdit(s),onMouseEnter:this.highlightElementToEdit(s),onMouseLeave:this.highlightElementToEdit(s),className:"mx-2"})))))))))}};const q={deleteUserFromFirebase:y,highligthChosenElement:F,onDeleteHoverHighlight:(e,t)=>r=>{try{r(T("mouseenter"===e?t:""))}catch(s){r(O(s))}},onEditHoverHighlight:(e,t)=>r=>{try{r(C("mouseenter"===e?t:""))}catch(s){r(O(s))}},redirect:D,sortUsersList:(e,t,r)=>async s=>{s({type:"SORT_PENDING"});try{const a={};Object.values(e).sort((e,s)=>((e,t,r)=>"asc"===r?e>t?1:-1:e>t?-1:1)(e[r],s[r],t)).map(({firstName:e,key:t,secondName:r,url:s})=>a[t]={firstName:e,key:t,secondName:r,url:s});const n={sortedByColumn:r,sortingOrder:t};s(((e,t,r)=>({sortColumn:r,sortingOrder:t,type:"SORT_FULFILLED",usersSorted:e}))(a,t="asc"===t?"desc":"asc",n))}catch(i){s((e=>({error:e.message,type:"SORT_REJECTED"}))(i))}}};var Q=Object(l.connect)(({firebase:{listElementIsEdited:e,sortingOrder:t,sortColumn:r,listElementToDelete:s,listElementToEdit:i,usersFiltered:a,usersSorted:n}})=>({listElementIsEdited:e,listElementToDelete:s,listElementToEdit:i,sortColumn:r,sortingOrder:t,usersFiltered:a,usersSorted:n}),q)(Y);var ee=class extends a.Component{constructor(){super(...arguments),this.filterList=(e=>({target:{value:t}})=>{this.props.filterUsersList(e,t)})}componentDidMount(){this.props.getUserFromFirebase()}componentDidUpdate(){const{editUser:e,match:t,users:r}=this.props;t.params.key&&r&&e(r[t.params.key])}render(){const{users:e,usersFiltered:t,isLoading:r,isError:s,match:i}=this.props;return a.createElement(j.Container,null,a.createElement(j.Row,{className:"mt-4"},a.createElement(j.Col,{lg:"8"},a.createElement("form",{className:"md-form"},a.createElement("input",{name:"filerList",type:"text",className:"form-control mb-2",placeholder:"Wpisz poszukiwanego u\u017cytkownika",onChange:this.filterList(e)})),r?a.createElement(j.Row,{className:"justify-content-center mt-5"},a.createElement(U.a,{type:"ball-clip-rotate-multiple",active:!0})):s?a.createElement("p",null,"Wyst\u0105pi\u0142 b\u0142\u0105d podczas pobierania danych!!!"):null!==t&&Object.values(t).length>0?a.createElement(Q,null):a.createElement("h2",null,"Brak listy do wy\u015bwietlenia")),a.createElement(j.Col,{lg:"4",className:"mt-3 mt-lg-0"},a.createElement(j.Card,null,a.createElement(j.CardBody,null,i.params.key?i.params.action&&"edit"===i.params.action?a.createElement(K,null):a.createElement(_,null):a.createElement(V,null))))))}};const te={editUser:f,filterUsersList:(e,t)=>async r=>{r({type:"FILTER_PENDING"});try{const i=Object.values(e).filter(({firstName:e,secondName:r})=>e.toLowerCase().includes(t)||r.toLowerCase().includes(t)),a={};i.forEach(({firstName:e,key:t,secondName:r,url:s})=>a[t]={firstName:e,key:t,secondName:r,url:s}),r(((e,t)=>({sortColumn:t,type:"FILTER_FULFILLED",usersFiltered:e}))(a,{sortedByColumn:"reset",sortingOrder:"reset"}))}catch(s){r((e=>({error:e.message,type:"FILTER_REJECTED"}))(s))}},getUserFromFirebase:()=>async(e,t,{base:r})=>{e({type:"RETRIEVE_PENDING"});try{e((e=>({type:"RETRIEVE_FULFILLED",users:e}))((await r.ref("users").once("value")).val()))}catch(s){e(N(s))}}};var re=Object(l.connect)(({firebase:{isError:e,isLoading:t,users:r,usersFiltered:s,usersSorted:i}})=>({isError:e,isLoading:t,users:r,usersFiltered:s,usersSorted:i}),te)(ee);const se=Object(i.a)(),ie=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||m.d,ae=Object(m.e)((e=>Object(m.c)({firebase:I,form:g.a,router:Object(s.connectRouter)(e)}))(se),ie(Object(m.a)(E.a.withExtraArgument({base:u,storage:p}),Object(s.routerMiddleware)(se))));Object(n.render)(a.createElement(()=>a.createElement(l.Provider,{store:ae},a.createElement(s.ConnectedRouter,{history:se},a.createElement("div",null,a.createElement(o.a,null,a.createElement(c.a,{path:"/:key?/:action?",component:re}))))),null),document.querySelector("#container"))}},[[115,2,1]]]);
//# sourceMappingURL=main.d9c68290.chunk.js.map